___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Trackify Free Consent CMP",
  "brand": {
    "id": "github.com_trackify-info",
    "displayName": "Trackify",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAGAGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMDEtMjNUMTk6NTI6MDUrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTAxLTIzVDE5OjU5OjA0KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzLTAxLTIzVDE5OjU5OjA0KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQyMDA5MTkyLWUzZWMtNGU5MC05ZDgwLTJkODdlODM2ZTMzYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmRmMTU0NDM4LTE2YjgtMmM0Zi1hNjNlLTE2OGZiYmVmYjNkOSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjUwYjQzOTIzLWNiMjEtNDEwNS05YzkwLTRmNGJhZTZmODg4MyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTBiNDM5MjMtY2IyMS00MTA1LTljOTAtNGY0YmFlNmY4ODgzIiBzdEV2dDp3aGVuPSIyMDIzLTAxLTIzVDE5OjUyOjA1KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NDIwMDkxOTItZTNlYy00ZTkwLTlkODAtMmQ4N2U4MzZlMzNjIiBzdEV2dDp3aGVuPSIyMDIzLTAxLTIzVDE5OjU5OjA0KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6x/jfBAAAVrElEQVR42u2deXjV1ZnH37P81rtlXyGAgGFTQRFsEBQBi3RU1NalU6t2nKltbR9H+zzT6XSmzzwzts8snakdO23tYlur1tpxdFrrAlUQcGEn7CQBAmHJnrv99nPe+ePeG0DRkksSArnneZJ7k9wt388573nPe97z/oiVTDYAAAcAhEIDAABEBMYZMM48znkgBKKUCJ7t8h3vNlY4lqMhARRSEASUM+Zc2lFaUZomlDDOKJFCsCAIlMAPCCHkdG/BNNNM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\u003d\u003d"
  },
  "description": "This is an Google Tag Manager Tag template for the Trackify Tracking Code, it respect the Google Consent Mode API",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "apiKey",
    "displayName": "Trackify API Key",
    "simpleValueType": true,
    "help": "You can activate an API Key, to use free statistics of consent usage"
  },
  {
    "type": "GROUP",
    "name": "configurationOptions",
    "displayName": "Configuration Options",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "TEXT",
        "name": "cookieLifetime",
        "displayName": "Lifetime of consent acknowledgement in days",
        "simpleValueType": true,
        "defaultValue": 365,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          },
          {
            "type": "POSITIVE_NUMBER"
          }
        ],
        "valueHint": "Number of days that the user has to re-confirm the cookie usage"
      },
      {
        "type": "CHECKBOX",
        "name": "changeConsentVals",
        "checkboxText": "User can change consent values on each page",
        "simpleValueType": true,
        "defaultValue": false
      },
      {
        "type": "TEXT",
        "name": "privacyPolicyURL",
        "displayName": "URL of your Privacy Policy",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ],
        "notSetText": "Please fill in the Link to your privacy policy url",
        "help": "",
        "valueHint": ""
      },
      {
        "type": "TEXT",
        "name": "imprintURL",
        "displayName": "URL of your imprint page",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ],
        "notSetText": "Please fill in the Link to your imprint url",
        "help": "",
        "valueHint": ""
      },
      {
        "type": "TEXT",
        "name": "logoSrc",
        "displayName": "URL of your Company Logo",
        "simpleValueType": true,
        "valueValidators": [],
        "notSetText": "Please fill in the Link to your company logo",
        "help": "",
        "valueHint": ""
      },
      {
        "type": "CHECKBOX",
        "name": "supportTrackify",
        "checkboxText": "Support Trackify",
        "simpleValueType": true,
        "defaultValue": true
      },
      {
        "type": "SELECT",
        "name": "themeColor",
        "displayName": "Theme Color",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "light",
            "displayValue": "Light"
          },
          {
            "value": "dark",
            "displayValue": "Dark"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "light"
      },
      {
        "type": "SELECT",
        "name": "lang",
        "displayName": "Consent Language",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "auto",
            "displayValue": "Auto Detect"
          },
          {
            "value": "en",
            "displayValue": "English"
          },
          {
            "value": "de",
            "displayValue": "German"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "auto"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "defaultConsentState",
    "displayName": "Default Consent State",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SELECT",
        "name": "defaultConsentPreferences",
        "displayName": "Preferences (consent types functionality_storage and personalization_storage)",
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "help": "Select default consent state for preference cookies",
        "defaultValue": "denied"
      },
      {
        "type": "SELECT",
        "name": "defaultConsentStatistics",
        "displayName": "Statistics (consent type analytics_storage)",
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "help": "Select default consent state for statistics cookies",
        "defaultValue": "denied"
      },
      {
        "type": "SELECT",
        "name": "defaultConsentMarketing",
        "displayName": "Marketing (consent type ad_storage)",
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "help": "Select default consent state for marketing cookies",
        "defaultValue": "denied"
      },
      {
        "type": "TEXT",
        "name": "waitForUpdate",
        "displayName": "Wait for update",
        "simpleValueType": true,
        "valueUnit": "miliseconds",
        "help": "Set how many miliseconds to wait before firing tags waiting for consent",
        "defaultValue": 2000,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          },
          {
            "type": "NON_NEGATIVE_NUMBER"
          }
        ]
      }
    ],
    "help": "Default measurement capabilities before the end user has consented."
  },
  {
    "type": "GROUP",
    "name": "customOptions",
    "displayName": "Custom Options",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "TEXT",
        "name": "customCss",
        "displayName": "Custom CSS Field",
        "simpleValueType": true,
        "lineCount": 12
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const injectScript = require('injectScript');
const setDefaultConsentState =require('setDefaultConsentState');
const queryPermission = require('queryPermission');
const callInWindow = require('callInWindow');
const setInWindow = require('setInWindow');
const consentVersion = '0.8';

setDefaultConsentState({
	'functional_storage': data.defaultConsentPreferences,
	'personalization_storage': data.defaultConsentPreferences,
	'analytics_storage': data.defaultConsentStatistics,
	'ad_storage': data.defaultConsentMarketing,
	'security_storage': 'granted',
	'wait_for_update': data.waitForUpdate
});

// onSuccess, onFailure for launching the tracking code
const onSuccess = () => {
  log('Consent Tool loaded successfully.');
  if(data.customCss){
    callInWindow('_TRACKIFYCMT.fn.setCustomCss', data.customCss);
  }
  data.gtmOnSuccess();
};

const onFailure = () => {
  log('Consent Tool has failed to load.');
  data.gtmOnFailure();
};

// Initialize tracker objects, Matomo Analytics queue
let jsConsent;

if (data.apiKey == undefined || data.apiKey == "") data.apiKey = "anonymous";

jsConsent = 'https://cdn.trackify.info/consent-management/v'+consentVersion+'/'+data.apiKey+'/'+data.lang+'/trackify.js';

var trackifyConfig = [{
    version: consentVersion,
    name: "default",
    elementID: 'consentbar',
    storageMethod: 'cookie',
    cookieName: 'trackifyconsent',
    cookieExpiresAfterDays: data.cookieLifetime,
    privacyPolicy: data.privacyPolicyURL,
    imprint: data.imprintURL,
    mustConsent: data.mustConsent,
    groupByPurpose: true,
    acceptAll: true,
    htmlTexts: true,
    id: data.apiKey,
    lang: 'auto',
    finger_button: data.changeConsentVals,
    hideDeclineAll: true,
    additionalClass: 'trackifyconsent',
    purposes: {
      presets: {
        functional_storage: data.defaultConsentPreferences,
        personalization_storage: data.defaultConsentPreferences,
        analytics_storage: data.defaultConsentStatistics,
        ad_storage: data.defaultConsentMarketing,
      },
    },
    disablePoweredBy: (data.supportTrackify !== undefined || data.supportTrackify !== false ) ? "true" : "false",
    styling: {
        theme: [data.themeColor, data.themePosition, 'wide'],
        branding: {
          src: data.logoSrc,
        },
        headline : {
          color : insert(data.styling_text_headline_color, "#4d5c6e")
        },
        description : {
          color : insert(data.styling_text_description_color, "#72879e")
        },
        categories : {
      details : {
        headline : {
          color : insert(data.styling_details_headline_color, "#72879e")
        },
        description : {
          color : insert(data.styling_details_description_color, "#72879e")
        }
      },
      checkboxes : {
        checkmark : "white",
        checkbox : {
          background : {
            checked : insert(data.styling_checkboxes_bg_box_checked, "#00c06d"),
            unchecked : insert(data.styling_checkboxes_bg_box_normal, "#eee")
          }
        },
        label : {
          color : insert(data.styling_checkboxes_color_label, "#72879e")
        }
      }
    },
    buttons : {
      accept_selected : {
        normal : {
          color : insert(data.btn_accept_selected_color_normal, "#b4b4b4"),
          background : insert(data.btn_accept_selected_bg_normal, "#fcfcfc")
        },
        hover : {
          color : insert(data.btn_accept_selected_color_hover, "#b4b4b4"),
          background : insert(data.btn_accept_selected_bg_hover, "#e1e1e1")
        }
      },
      accept_all : {
        normal : {
          color : insert(data.btn_accept_all_color_normal, "white"),
          background : insert(data.btn_accept_all_bg_normal, "#00c06d")
        },
        hover : {
          color : insert(data.btn_accept_all_color_hover, "white"),
          background : insert(data.btn_accept_all_bg_hover, "#00a75f")
        }
      },
      privacy_link : {
        normal : {
          color : insert(data.btn_privacy_color_normal, "#4d5c6e"),
          background : insert(data.btn_privacy_bg_normal, "white")
        },
        hover : {
          color : insert(data.btn_privacy_color_hover, "#4d5c6e"),
          background : insert(data.btn_privacy_bg_hover, "#e1e1e1")
        }
      },
      fingerprint : {
        normal : {
          color : insert(data.btn_fingerprint_color_normal, "white"),
          background : insert(data.btn_fingerprint_bg_normal, "#4d5c6e")
        },
        hover : {
          color : insert(data.btn_fingerprint_color_hover, "white"),
          background : insert(data.btn_fingerprint_bg_hover, "#333")
        }
      }
    }
  },
    translations: {
        de: {
            privacyPolicyUrl: data.privacyPolicyURL,
            consentModal: {
                title: 'Cookie Zustimmung',
                description:
                    'Hier können Sie einsehen und anpassen, welche Cookies wir nutzen um Ihnen ein möglichst optimales und auf Ihre Bedürfnisse zugeschnittenes Webseiten-Erlebnis zu bieten. Dazu zählen Cookies, die für den reibungslosen Betrieb der Seite und deren Sicherheit notwendig sind sowie solche, die zu anonymen Statistikzwecken genutzt werden. Sie können selbst entscheiden, welche der Kategorien Sie erlauben möchten.',
            },
            details_link : {
              hidden : insert(data.content_de_main_more, "mehr Details anzeigen"),
              visible : insert(data.content_de_main_less, "Details ausblenden")
            },
      categories : {
        functional_storage : {
          title : insert(data.content_de_functional_storage_label, "Notwendig"),
          headline : insert(data.content_de_functional_storage_headline, "Notwendige Cookies"),
          description : insert(data.content_de_functional_storage_description, "Notwendige Cookies werden genutzt um unsere Webseite nutzbar zu machen. Grundfunktionen wie z.B. der Zugriff auf sichere Bereiche der Webseite werden so ermöglicht. Ohne diese Cookies kann unsere Website nicht funktionieren.")
        },
        personalization_storage : {
          title : insert(data.content_de_preferences_label, "Präferenzen"),
          headline : insert(data.content_de_preferences_headline, "Präferenzen Cookies"),
          description : insert(data.content_de_preferences_description, "Präferenz-Cookies sorgen dafür, dass wir Nutzer-Einstellungen auf unserer Webseite speichern können. Das betrifft zum Beispiel die Art wie sich unsere Webseite verhält/aussieht oder Ihre bevorzugte Sprache.")
        },
        analytics_storage : {
          title : insert(data.content_de_statistics_label, "Statistik"),
          headline : insert(data.content_de_statistics_headline, "Statistik Cookies"),
          description : insert(data.content_de_statistics_description, "Statistik-Cookies uns zu verstehen, wie Besucher mit unserer Webseite interagieren, indem Informationen anonym gesammelt und gemeldet werden. Das hilft uns dabei unser Webangebot konstant weiterzuentwickeln und zu verbessern.")
        },
        ad_storage : {
          title : insert(data.content_marketing_label, "Marketing"),
          headline : insert(data.content_marketing_headline, "Marketing Cookies"),
          description : insert(data.content_de_marketing_description, "Marketing-Cookies werden von uns verwendet, um Besuchern auf Webseiten zu folgen. Dadurch können wir Anzeigen zeigen, die relevant und ansprechend für Sie sind.")
        }
      },
      buttons : {
        show_categories : insert(data.content_de_btn_accept_selected, "Auswahl anzeigen"),
        accept_selected : insert(data.content_de_btn_accept_selected, "Auswahl bestätigen"),
        accept_all : insert(data.content_de_btn_accept_all, "Alle Cookies akzeptieren"),
        privacyPolicy : insert(data.content_de_btn_privacy, "Datenschutzerklärung"),
        imprint : insert(data.content_de_btn_imprint, "Impressum"),
      }
        },
        en: {
            consentModal: {
                title: 'Cookie Consent',
                description:
                    'Here you can see and customize the information that we collect about you.',
            },
            youtube: {
                title: 'YouTube',
                description: 'Some pages may contain integrated content from YouTube, e.g. an inline video.'
            },
            externalTracker: {
                description: 'Example of an external tracking script',
            },
            adsense: {
                description: 'Displaying of advertisements (just an example)',
                title: 'Google Adsense Advertisement',
            },
            matomo: {
                description: 'Collecting of visitor statistics',
            },
            camera: {
                description:
                    'A surveillance camera (just an example for an IMG tag)',
            },
            cloudflare: {
                description: 'Protection against DDoS attacks',
            },
            intercom: {
                description:
                    'Chat widget & collecting of visitor statistics (just an example)',
            },
            mouseflow: {
                description: 'Real-Time user analytics (just an example)',
            },
            googleFonts: {
                description: 'Web fonts hosted by Google',
            },
            purposes: {
                essential: 'Essential',
                marketing: 'Marketing',
                analytics: 'Analytics',
                advertising: 'Advertising',
            },
        },
    },
}];

setInWindow('trackifyConfig', trackifyConfig);

// After specifying the options, a function needs to run that specifies the tracking URL, website UUID
// and injects the tracking code into <head>
const injectConsent = jsConsent => {
  injectScript(jsConsent, onSuccess, onFailure, jsConsent);
};

// Launch the tracking code

if (queryPermission('inject_script', jsConsent)) {
  injectConsent(jsConsent);
} else {
  log('Warning: Script load failed due to permissions mismatch.');
  data.gtmOnFailure();
}

function insert(val, fallback){
  return (val !== undefined && val !== "") ? val : fallback;
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "trackifyConfig"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "setCustomCss"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.trackify.info/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functional_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "wait_for_update"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Analytics queue is initiated
  code: |2-
        // Call runCode to run the template's code.
        runCode(mockData);

        // Verify that the tag finished successfully.
        //assertApi('createQueue').wasCalled();
- name: Tracker script completly launched
  code: |2-
            // Mock injectScript
            mock('injectScript', (url, onSuccess, onFailure) => {
              onSuccess();
            });

            // Call runCode to run the template's code.
            runCode(mockData);

            // Verify that the tag finished successfully.
            assertApi('injectScript').wasCalled();
            assertApi('gtmOnSuccess').wasCalled();
setup: |2-
      const mockData = {
        instanceURL: "https://stats.trackify.info/",
        websiteID: "1",
        useAlternativeNamespace: false,
        analyticsDomains: ["example.com"]
      };


___NOTES___

Created on 11.10.2021, 21:15:42
